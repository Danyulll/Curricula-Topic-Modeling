<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Curricula-Topic-Modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-to-topic-modeling-and-lda" id="toc-introduction-to-topic-modeling-and-lda" class="nav-link active" data-scroll-target="#introduction-to-topic-modeling-and-lda">Introduction to Topic Modeling and LDA</a>
  <ul>
  <li><a href="#terminology" id="toc-terminology" class="nav-link" data-scroll-target="#terminology">Terminology</a></li>
  <li><a href="#topic-models" id="toc-topic-models" class="nav-link" data-scroll-target="#topic-models">Topic Models</a></li>
  <li><a href="#latent-dirichlet-allocation" id="toc-latent-dirichlet-allocation" class="nav-link" data-scroll-target="#latent-dirichlet-allocation">Latent Dirichlet Allocation</a></li>
  </ul></li>
  <li><a href="#feature-extraction-and-preprocessing" id="toc-feature-extraction-and-preprocessing" class="nav-link" data-scroll-target="#feature-extraction-and-preprocessing">Feature Extraction and Preprocessing</a>
  <ul>
  <li><a href="#document-term-matrices" id="toc-document-term-matrices" class="nav-link" data-scroll-target="#document-term-matrices">Document-Term Matrices</a></li>
  <li><a href="#complexity-reduction" id="toc-complexity-reduction" class="nav-link" data-scroll-target="#complexity-reduction">Complexity Reduction</a></li>
  <li><a href="#tf-idf" id="toc-tf-idf" class="nav-link" data-scroll-target="#tf-idf">TF-IDf</a></li>
  </ul></li>
  <li><a href="#exploring-degree-pathways" id="toc-exploring-degree-pathways" class="nav-link" data-scroll-target="#exploring-degree-pathways">Exploring Degree Pathways</a>
  <ul>
  <li><a href="#topic-number-discovery" id="toc-topic-number-discovery" class="nav-link" data-scroll-target="#topic-number-discovery">Topic Number Discovery</a>
  <ul class="collapse">
  <li><a href="#perplexity" id="toc-perplexity" class="nav-link" data-scroll-target="#perplexity">Perplexity</a></li>
  <li><a href="#coherence" id="toc-coherence" class="nav-link" data-scroll-target="#coherence">Coherence</a></li>
  <li><a href="#ldatuning" id="toc-ldatuning" class="nav-link" data-scroll-target="#ldatuning">ldatuning</a></li>
  <li><a href="#visualizing-topics-with-ldavis" id="toc-visualizing-topics-with-ldavis" class="nav-link" data-scroll-target="#visualizing-topics-with-ldavis">Visualizing topics with LDAvis</a></li>
  </ul></li>
  <li><a href="#inspecting-beta" id="toc-inspecting-beta" class="nav-link" data-scroll-target="#inspecting-beta">Inspecting <span class="math inline">\(\beta\)</span></a></li>
  <li><a href="#inspecting-gamma" id="toc-inspecting-gamma" class="nav-link" data-scroll-target="#inspecting-gamma">Inspecting <span class="math inline">\(\gamma\)</span></a></li>
  </ul></li>
  <li><a href="#inspecting-other-solutions" id="toc-inspecting-other-solutions" class="nav-link" data-scroll-target="#inspecting-other-solutions">Inspecting Other Solutions</a>
  <ul>
  <li><a href="#group-solution" id="toc-group-solution" class="nav-link" data-scroll-target="#group-solution">5 Group Solution</a></li>
  <li><a href="#group-solution-1" id="toc-group-solution-1" class="nav-link" data-scroll-target="#group-solution-1">8 Group Solution</a></li>
  <li><a href="#group-solution-2" id="toc-group-solution-2" class="nav-link" data-scroll-target="#group-solution-2">10 Group Solution</a></li>
  </ul></li>
  <li><a href="#work-in-progress" id="toc-work-in-progress" class="nav-link" data-scroll-target="#work-in-progress">Work in progress</a>
  <ul>
  <li><a href="#no-tf-idf" id="toc-no-tf-idf" class="nav-link" data-scroll-target="#no-tf-idf">No TF-IDF</a>
  <ul class="collapse">
  <li><a href="#group-solution-3" id="toc-group-solution-3" class="nav-link" data-scroll-target="#group-solution-3">5 Group Solution</a></li>
  <li><a href="#group-solution-4" id="toc-group-solution-4" class="nav-link" data-scroll-target="#group-solution-4">8 Group Solution</a></li>
  <li><a href="#group-solution-5" id="toc-group-solution-5" class="nav-link" data-scroll-target="#group-solution-5">10 Group Solution</a></li>
  </ul></li>
  <li><a href="#tf-idf-25th-percentile" id="toc-tf-idf-25th-percentile" class="nav-link" data-scroll-target="#tf-idf-25th-percentile">TF-IDF 25th Percentile</a>
  <ul class="collapse">
  <li><a href="#group-solution-6" id="toc-group-solution-6" class="nav-link" data-scroll-target="#group-solution-6">5 Group Solution</a></li>
  <li><a href="#group-solution-7" id="toc-group-solution-7" class="nav-link" data-scroll-target="#group-solution-7">8 Group Solution</a></li>
  <li><a href="#group-solution-8" id="toc-group-solution-8" class="nav-link" data-scroll-target="#group-solution-8">10 Group Solution</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Curricula-Topic-Modeling</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction-to-topic-modeling-and-lda" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-topic-modeling-and-lda">Introduction to Topic Modeling and LDA</h2>
<section id="terminology" class="level3">
<h3 class="anchored" data-anchor-id="terminology">Terminology</h3>
<p>Before beginning there are three important preliminary definitions one will need in any text analysis:</p>
<ul>
<li>Document: a distinct text object that one wishes to analyze. This could be a paper, a paragraph, etc.</li>
<li>Term: an individual word in a given document.</li>
<li>Corpus: The set of all documents.</li>
</ul>
</section>
<section id="topic-models" class="level3">
<h3 class="anchored" data-anchor-id="topic-models">Topic Models</h3>
<p>Topic Modeling is a statistical model that attempts to cluster the words found in a document into various “topics”. The hope is that these topics would capture some underlying subject contained within the text. It is important to note that Topic Models are fuzzy in the sense that documents are assumed to be comprised of multiple topics with varying degrees of membership to each.</p>
</section>
<section id="latent-dirichlet-allocation" class="level3">
<h3 class="anchored" data-anchor-id="latent-dirichlet-allocation">Latent Dirichlet Allocation</h3>
<p>Perhaps the most famous topic model is <em>Latent Dirichlet Allocation</em> (LDA) (Blei et al., 2003). It is a three-level hierarchical Bayesian model that defines a collection of documents as a random mixture over some underlying topic set where each topic is itself a distribution over our vocabulary.</p>
<p>LDA works by assuming a data generating process (DGP) for our documents and then employs inference to discover the most likely parameters (Grimmer et al., 2022).</p>
<p>Blei, Ng, and Jordan define the following DGP (2003):</p>
<ol type="1">
<li>Choose <span class="math inline">\(N \sim\)</span> Poisson(<span class="math inline">\(\xi\)</span>)</li>
<li>Choose <span class="math inline">\(\theta \sim\)</span> Dir(<span class="math inline">\(\alpha\)</span>)</li>
<li>For each of the <span class="math inline">\(N\)</span> words <span class="math inline">\(w_n\)</span>:
<ol type="1">
<li>Choose a topic <span class="math inline">\(z_n\sim\)</span>Multinomial(<span class="math inline">\(\theta\)</span>)</li>
<li>Choose a word <span class="math inline">\(w_n\)</span> from <span class="math inline">\(p(w_n|z_n,\beta)\)</span>, a multinomial probability conditioned on the topic <span class="math inline">\(z_n\)</span></li>
</ol></li>
</ol>
<p>For the following analysis we estimate the parameters using the <em>collapsed Gibbs sampling method</em>, though it is important to note there are others that yield varied results. To further complicate things, when fitting LDA in R one must predefine the number of topics for the model. Finding a good estimate for the number of topics is paramount and many methods are explored.</p>
<p>Once a model is fitted, it is common to extract 2 matrices <span class="math inline">\(\Phi\)</span> and <span class="math inline">\(\Theta\)</span>. These are also commonly referred to as <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span> respectively. Both are given by the priors of LDA. <span class="math inline">\(\Phi\)</span> represents the probability mass over the terms. <span class="math inline">\(\Theta\)</span> represents the probability mass function over the topics or the per-document-per-topic probabilities.</p>
</section>
</section>
<section id="feature-extraction-and-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="feature-extraction-and-preprocessing">Feature Extraction and Preprocessing</h2>
<section id="document-term-matrices" class="level3">
<h3 class="anchored" data-anchor-id="document-term-matrices">Document-Term Matrices</h3>
<p>There are many methods of feature extraction from text, we opt for the <em>bag of words</em> model. To construct this model simply define a common set of words shared between documents and store a count of word appearances for each document. Commonly this is stored as a <em>Document-Term Matrix</em> (DTM), for example, given the documents:</p>
<div id="tbl-panel" class="tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Corpus</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Document 1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">“I am happy”</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Document 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">“I am sad”</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>the corresponding DTM would be</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: left;">I</th>
<th style="text-align: right;">am</th>
<th style="text-align: center;">happy</th>
<th style="text-align: center;">sad</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Doc 1</strong></td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td><strong>Doc 2</strong></td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p>In R we can us the tm package to create our Corpus and DTM objects. For these examples scrapped Data Science course information, from various universities, will be preprocessed.</p>
<p>First this data will be examined from a degree pathway perspective with the documents being concatenated course descriptions for entire curricula. These curricula are constructed for each university by sampling courses from each university’s Data Science course calendar.</p>
<div class="cell" data-hash="index_cache/html/Libraries_e47d760b0ad8c1733e6e22f87f83cc23">

</div>
<div class="cell" data-hash="index_cache/html/Load in Data_773c2eb0b35f66fb684949adeb618f4b">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading in data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../data/RObjects/degree_corpus.RData"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examining which universities are represented </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(degree_corpus<span class="sc">$</span>doc_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Western"   "Waterloo"  "Toronto"   "SFU"       "Manitoba"  "Laurier"  
[7] "Concordia" "Berkeley"  "UBCO"     </code></pre>
</div>
</div>
<div class="cell" data-hash="index_cache/html/Constructing Corpus_3b76359c56d11d80eea1cfbce6210206">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">DataframeSource</span>(degree_corpus)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(ds)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(corpus[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;SimpleCorpus&gt;&gt;
Metadata:  corpus specific: 1, document level (indexed): 0
Content:  documents: 1

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Western 
Lists, stacks, queues, priority queues, trees, graphs, and their associated algorithms; file structures; sorting, searching, and hashing techniques; time and space complexity. An introduction to software tools and systems programming. Topics include: understanding how programs execute (compilation, linking and loading); an introduction to a complex operating system (UNIX); scripting languages; the C programming language; system calls; memory management; libraries; multi-component program organization and builds; version control; debuggers and profilers. A team project course that provides practical experience in the software engineering field. Introduction to the structure and unique characteristics of large software systems, and concepts and techniques in the design, management and implementation of large software systems. This course presents an introduction to the mathematical foundations of computer science, with an emphasis on mathematical reasoning, combinatorial analysis, discrete structures, applications and modeling, and algorithmic thinking. Topics include sets, functions, relations, algorithms, number theory, matrices, mathematical reasoning, counting, graphs and trees. A study of relational databases. Theoretical concepts will be covered, including relational algebra and relational calculus. Commercially available database systems will be used to demonstrate concepts such as Structured-Query-Language (SQL), writing code to connect and query a database, query optimization, Atomicity-Consistency-Isolation-Durability (ACID) concepts, and database design. Upper and lower time and space bounds; levels of intractability; graph algorithms; greedy algorithms; dynamic algorithms; exhaustive search techniques; parallel algorithms. Covers three basic concepts of data science together with the corresponding techniques: Sampling to estimate properties of a population (Bootstrap), random assignment and experiments to make causal inferences (randomization test), and model selection to enable good predictions (cross-validation). Emphasizes practical data handling and programming skills in Python. Basic principles of machine learning (estimation, optimization, prediction, generalization, bias-variance trade-off, regularization) in the context of supervised (linear models, decision trees, deep neuronal networks) and unsupervised (clustering and dimensionality reduction) statistical learning techniques. The course emphasizes the ability to apply techniques to real data sets and critically evaluate their performance. Logic, sets and functions, algorithms, mathematical reasoning, counting, relations, graphs, trees, Boolean Algebra, computation, modeling. This course provides an introduction to logical reasoning and proofs. Topics include sets, counting (permutations and combinations), mathematical induction, relations and functions, partial order relations, equivalence relations, binary operations, elementary group theory and applications to error-correcting codes. Probability axioms, conditional probability, Bayes' theorem. Random variables motivated by real data and examples. Parametric univariate models as data reduction and description strategies. Multivariate distributions, expectation and variance. Likelihood function will be defined and exploited as a means of estimating parameters in certain simple situations. An introduction to the theory of statistics with strong links to data as well as its probabilistic underpinnings. Topics covered include estimation and hypothesis testing, sampling distributions, linear regression, experimental design, law of large numbers and central limit theorem. An introduction to programming using a high level language (currently R). A case study approach to how data are collected in science, social science and medicine, including the methods of designed experiments, sample surveys, observational studies and administrative records. Simple and multiple linear regression models and their use to model data using computing including model specification and assumptions, inference and estimation, use of indicator variables, regression diagnostics, model building and selection. Introduction to forecasting and time series. Estimation and tests for generalized linear models, including residual analysis and the use of statistical packages. Logistic regression, log-linear models. Additional topics may include generalized estimating equations, quasi-likelihood and generalized additive models. </code></pre>
</div>
</div>
<p>As shown the first element of the corpus is from Western University and contains all course description terms from a given pathway through their Data Science calendar.</p>
</section>
<section id="complexity-reduction" class="level3">
<h3 class="anchored" data-anchor-id="complexity-reduction">Complexity Reduction</h3>
<p>Raw text data lends itself to difficult analysis. NLP posses several best practices for cleaning text:</p>
<ul>
<li>Punctation/Number Removal: deleting any non alphabetic characters.</li>
<li>Lowercasing: sending all words to lowercase.</li>
<li>Stopword Removal: stopwords are words used often in sentences that give little to no information, i.e., atricles such as the, a, etc.</li>
<li>Stemming: truncating the ends of words so that they share a common base, i.e., fishing and fishes would be transformed ot fish.</li>
<li>Tokenizing: dividing a document into a set of individual words</li>
</ul>
<div class="cell" data-hash="index_cache/html/Text Preprocessing_f14f6c5b519315f1437ba18d120e211a">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove punctuation</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(removePunctuation))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Send everything to lower case</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(tolower))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove stopwords</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(removeWords), </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove whitespace</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, stripWhitespace)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove numbers</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(removeNumbers))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove custom stop words</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="cf">function</span>(x) {<span class="fu">removeWords</span>(x,<span class="fu">c</span>(<span class="st">"data"</span>,<span class="st">"will"</span>,<span class="st">"students"</span>,<span class="st">"fall"</span>,<span class="st">"spring"</span>,<span class="st">"important"</span>,<span class="st">"one"</span>,<span class="st">"considered"</span>,<span class="st">"stacks"</span>,<span class="st">"offers"</span>,<span class="st">"types"</span>,<span class="st">"may"</span>,<span class="st">"held"</span>,<span class="st">"former"</span>,<span class="st">"honours"</span>,<span class="st">"faculty"</span>,<span class="st">"related"</span>,<span class="st">"enter"</span>,<span class="st">"review"</span>,<span class="st">"enrolment"</span>,<span class="st">"exercises"</span>,<span class="st">"summer"</span>,<span class="st">"need"</span>,<span class="st">"offered"</span>))})</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Stemming</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, stemDocument)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(corpus[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;SimpleCorpus&gt;&gt;
Metadata:  corpus specific: 1, document level (indexed): 0
Content:  documents: 1

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Western 
list queue prioriti queue tree graph associ algorithm file structur sort search hash techniqu time space complex introduct softwar tool system program topic includ understand program execut compil link load introduct complex oper system unix script languag c program languag system call memori manag librari multicompon program organ build version control debugg profil team project cours provid practic experi softwar engin field introduct structur uniqu characterist larg softwar system concept techniqu design manag implement larg softwar system cours present introduct mathemat foundat comput scienc emphasi mathemat reason combinatori analysi discret structur applic model algorithm think topic includ set function relat algorithm number theori matric mathemat reason count graph tree studi relat databas theoret concept cover includ relat algebra relat calculus commerci avail databas system use demonstr concept structuredquerylanguag sql write code connect queri databas queri optim atomicityconsistencyisolationdur acid concept databas design upper lower time space bound level intract graph algorithm greedi algorithm dynam algorithm exhaust search techniqu parallel algorithm cover three basic concept scienc togeth correspond techniqu sampl estim properti popul bootstrap random assign experi make causal infer random test model select enabl good predict crossvalid emphas practic handl program skill python basic principl machin learn estim optim predict general biasvari tradeoff regular context supervis linear model decis tree deep neuron network unsupervis cluster dimension reduct statist learn techniqu cours emphas abil appli techniqu real set critic evalu perform logic set function algorithm mathemat reason count relat graph tree boolean algebra comput model cours provid introduct logic reason proof topic includ set count permut combin mathemat induct relat function partial order relat equival relat binari oper elementari group theori applic errorcorrect code probabl axiom condit probabl bay theorem random variabl motiv real exampl parametr univari model reduct descript strategi multivari distribut expect varianc likelihood function defin exploit mean estim paramet certain simpl situat introduct theori statist strong link well probabilist underpin topic cover includ estim hypothesi test sampl distribut linear regress experiment design law larg number central limit theorem introduct program use high level languag current r case studi approach collect scienc social scienc medicin includ method design experi sampl survey observ studi administr record simpl multipl linear regress model use model use comput includ model specif assumpt infer estim use indic variabl regress diagnost model build select introduct forecast time seri estim test general linear model includ residu analysi use statist packag logist regress loglinear model addit topic includ general estim equat quasilikelihood general addit model </code></pre>
</div>
</div>
<p>Now we may construct our DTM,</p>
<div class="cell" data-hash="index_cache/html/DTM Construction_fce4ecb78f1adc8be7ff687484921dd4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DTM object</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> <span class="fu">DocumentTermMatrix</span>(corpus)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(dtm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;DocumentTermMatrix (documents: 9, terms: 9)&gt;&gt;
Non-/sparse entries: 57/24
Sparsity           : 30%
Maximal term length: 9
Weighting          : term frequency (tf)
Sample             :
           Terms
Docs        abil acid addit administr algebra algorithm analysi appli applic
  Berkeley     1    0     0         0       2         2       3     1      3
  Concordia    0    0     0         0       2         5       7     1      8
  Laurier      2    0     2         0       1        13      14     2      7
  Manitoba     0    0     0         0       1         4      11     1      4
  SFU          1    0     0         1       0         7      16     2      9
  Toronto      0    0     2         0       1        10       9     3      9
  UBCO         0    0     2         0       1         3       7     4     10
  Waterloo     1    0     1         2       0        15       5     2      9
  Western      1    1     2         1       2         8       2     1      2</code></pre>
</div>
</div>
</section>
<section id="tf-idf" class="level3">
<h3 class="anchored" data-anchor-id="tf-idf">TF-IDf</h3>
<p>If one wishes to further reduce complexity there exist various heuristics for term inclusion. One such heuristic is <em>term frequency inverse document frequency</em> (TF-IDF). The intuition for TF-IDF is that extremely frequent words hold language together but do not provide great insight of topic or context. Meanwhile rare words contain a plethora of information but lack the frequency needed to be used in generalizations. Therefore words somewhere in the middle of these extremes ought to be included (Grimmer et al., 2022).</p>
<p>The quantity itself is the multiplication of the <em>term frequency</em> (TF) and <em>inverse document drequency</em> (IDF). TF is simply the number of times the term <span class="math inline">\(j\)</span> appears in a given document. IDF is defined as</p>
<p><span class="math display">\[idf(term)=ln\left(\frac{{\text{\# of doucments}}}{{\text{\# documents containing term j}}}\right)\]</span></p>
<p>IDF is a penalty term that adjusts term frequency based on the term’s rarity (Silge &amp; Robinson, 2017).</p>
<div class="cell" data-hash="index_cache/html/TF-IDF weighting 1_bd6d7b48391fad85706cd742f2e655ee">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tfidf_dtm <span class="ot">&lt;-</span> <span class="fu">weightTfIdf</span>(dtm)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(tfidf_dtm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;DocumentTermMatrix (documents: 9, terms: 5)&gt;&gt;
Non-/sparse entries: 21/24
Sparsity           : 53%
Maximal term length: 9
Weighting          : term frequency - inverse document frequency (normalized) (tf-idf)
Sample             :
           Terms
Docs                abil        acid        addit   administr      algebra
  Berkeley  0.0021687900 0.000000000 0.0000000000 0.000000000 0.0018545784
  Concordia 0.0000000000 0.000000000 0.0000000000 0.000000000 0.0012065560
  Laurier   0.0014180550 0.000000000 0.0014180550 0.000000000 0.0003031522
  Manitoba  0.0000000000 0.000000000 0.0000000000 0.000000000 0.0004306058
  SFU       0.0008321854 0.000000000 0.0000000000 0.001555410 0.0000000000
  Toronto   0.0000000000 0.000000000 0.0019250781 0.000000000 0.0004115438
  UBCO      0.0000000000 0.000000000 0.0026458562 0.000000000 0.0005656319
  Waterloo  0.0008609106 0.000000000 0.0008609106 0.003218198 0.0000000000
  Western   0.0020938195 0.007826975 0.0041876390 0.003913488 0.0017904695</code></pre>
</div>
</div>
<p>Now our DTM contains TF-IDF scores as the entries as opposed to just TF. We can now filter away terms below a certain threshold of TF-IDF. A common approach is to filter terms away below the median.</p>
<div class="cell" data-hash="index_cache/html/TF-IDF Median Calc_224a7c93476170541a83f5475abc354c">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tfidf_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tfidf_dtm)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(tfidf_mat[tfidf_mat <span class="sc">&gt;</span> <span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00220297</code></pre>
</div>
</div>
<div class="cell" data-hash="index_cache/html/Filter TF-IDF below median_6473b962d7578f6cd895eb4515b9a1bf">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tfidf_dtm_r <span class="ot">&lt;-</span> tfidf_dtm[,tfidf_dtm<span class="sc">$</span>v <span class="sc">&gt;</span> <span class="fl">0.0022</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="index_cache/html/TF-IDF DTM Dimensionality_b38e6ad604142c0caabc2cd84faec6b1">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dimensions before reduction</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tfidf_dtm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    9 1448</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dimensions after reduction</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tfidf_dtm_r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   9 702</code></pre>
</div>
</div>
<p>With this our dimensionality has sufficiently reduced. It is important to note when we fit a LDA model the topicmodels package in R requires us to have term frequencies as our DTM entries so we must convert back to a TF weighting.</p>
<div class="cell" data-hash="index_cache/html/Convert back to TF weighting_79b1e76ecec6f9367d54adc8452968dc">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get our list of tfidf terms       </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> tfidf_dtm_r<span class="sc">$</span>dimnames<span class="sc">$</span>Terms</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter our original dtm</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> dtm[,<span class="fu">which</span>(dtm<span class="sc">$</span>dimnames<span class="sc">$</span>Terms <span class="sc">%in%</span> terms)]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check to make sure we filtered the correct terms</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(dtm<span class="sc">$</span>dimnames<span class="sc">$</span>Terms <span class="sc">==</span> terms) <span class="sc">==</span> <span class="dv">702</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
</section>
<section id="exploring-degree-pathways" class="level2">
<h2 class="anchored" data-anchor-id="exploring-degree-pathways">Exploring Degree Pathways</h2>
<section id="topic-number-discovery" class="level3">
<h3 class="anchored" data-anchor-id="topic-number-discovery">Topic Number Discovery</h3>
<p>LDA, like many unsupervised learning methods, is extremely dependent on its parameters. One such parameter that requires meticulous tuning is the number of topics. In the literature there exist many metrics for discovering the optimal number of topics with several being readily available in R.</p>
<section id="perplexity" class="level4">
<h4 class="anchored" data-anchor-id="perplexity">Perplexity</h4>
<p>Perplexity is a measure of a model’s ability to generalize to unseen data. It is the log-likelihood of a a test set of data and is given by Pleplé:</p>
<p><span class="math display">\[\ell(w)=\text{log}p(w|\Phi,\alpha)=\sum_d \text{log} p(w_d|\Phi,\alpha)\]</span></p>
<ul>
<li><span class="math inline">\(w_d\)</span>: the unseen document</li>
<li><span class="math inline">\(\Phi\)</span>: the matrix for the topics</li>
<li><span class="math inline">\(\alpha\)</span>: the hyperparameter for the topic distributions</li>
</ul>
<p>The lower our perplexity score the better. We can use 3-fold cross validation and plot our perplexities for various topic numbers.</p>
<div class="cell" data-hash="index_cache/html/Perplexity 3-fold CV_3888c5db03759908a4be796add3159ec">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">87460945</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate folds</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>idxs <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="dv">9</span>))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">split</span>(idxs, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">9</span>))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define number of topics</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>topics <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">50</span>, <span class="dv">1</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame for storing results</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross validation</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> topics) {</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  scores <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    test_idx <span class="ot">&lt;-</span> folds[[i]]</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    train_idx <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">unlist</span>(folds, <span class="at">use.names =</span> <span class="cn">FALSE</span>), test_idx)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> dtm[test_idx, ]</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    train <span class="ot">&lt;-</span> dtm[train_idx, ]</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    LDA.out <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm, k, <span class="at">method =</span> <span class="st">"Gibbs"</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">perplexity</span>(LDA.out, <span class="at">newdata =</span> test)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    scores <span class="ot">&lt;-</span> <span class="fu">c</span>(scores, p)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"K"</span> <span class="ot">=</span> k, <span class="st">"Perplexity"</span> <span class="ot">=</span> <span class="fu">mean</span>(scores))</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, temp)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Perplexity vs. K</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x=</span>K, <span class="at">y=</span>Perplexity)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Perplexity vs. Number of Topics K"</span>)<span class="sc">+</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/Perplexity%203-fold%20CV-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="index_cache/html/min Perplexity_53bbd5a18171c034f4600b3b2c436318">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieving K for minimum Perplexity</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>results[<span class="fu">which.min</span>(results<span class="sc">$</span>Perplexity),<span class="st">"K"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
</div>
<p>Looks like in terms of Perplexity 8 is our optimal number of topics.</p>
</section>
<section id="coherence" class="level4">
<h4 class="anchored" data-anchor-id="coherence">Coherence</h4>
<p><strong>TO DO Do this when I have time</strong></p>
</section>
<section id="ldatuning" class="level4">
<h4 class="anchored" data-anchor-id="ldatuning">ldatuning</h4>
<p>The ldatuning package provides us with several metrics to evaluate the number topics all of which rely on find extrema. We seek to minimize Arun2010 and CaoJuan2009 and maximize Deveaud2014 and Griffiths2004.</p>
<div class="cell" data-hash="index_cache/html/ldatuning k 40_79f9269ff5ba4c036ec3ea402e0305e4">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find number of topics</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">FindTopicsNumber</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  dtm,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">topics =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2</span>, <span class="at">to =</span> <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">c</span>(<span class="st">"Griffiths2004"</span>, <span class="st">"CaoJuan2009"</span>, <span class="st">"Arun2010"</span>, <span class="st">"Deveaud2014"</span>),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"Gibbs"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">seed =</span> <span class="dv">77</span>),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">mc.cores =</span> 2L,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot metrics</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">FindTopicsNumber_plot</span>(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/ldatuning%20k%2040-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It seems no topic numbers over 21 are viable. Let us zoom in on the 2-21 range.</p>
<div class="cell" data-hash="index_cache/html/ldatuning k 21_6bff6b7add9d56f6ed030ddc0b220108">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find number of topics</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">FindTopicsNumber</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  dtm,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">topics =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2</span>, <span class="at">to =</span> <span class="dv">21</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">c</span>(<span class="st">"Griffiths2004"</span>, <span class="st">"CaoJuan2009"</span>, <span class="st">"Arun2010"</span>, <span class="st">"Deveaud2014"</span>),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"Gibbs"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">seed =</span> <span class="dv">77</span>),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">mc.cores =</span> 2L,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot metrics</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">FindTopicsNumber_plot</span>(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/ldatuning%20k%2021-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>For our minima we see CaoJuan2009 suggests 6 and 9 while Arun2019 promots 19. Examining our maxima we find Deveaud2014 is uninterpretable and Griffiths2004 recommends 10 and 20. This provides us with a good range of topic numbers to explore, <span class="math inline">\(k = 6,8,9,10,19,20\)</span>.</p>
</section>
<section id="visualizing-topics-with-ldavis" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-topics-with-ldavis">Visualizing topics with LDAvis</h4>
<p>Rather than individually fit each model model for our topic numbers the R package LDAvis creates a fantastic interactable visualization of our LDA model. LDAvis tries to answer 3 questions (Sievert &amp; Shirley, 2014):</p>
<ul>
<li>How prevalent is each topic?</li>
<li>How do the topics relate to each other?</li>
<li>How do the topics relate to each other?</li>
</ul>
<div class="cell" data-hash="index_cache/html/LDAvis_6741a747b99db5e14e4571aed7d7a0f6">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit largest model</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>lda.out <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm, <span class="dv">19</span>, <span class="at">method =</span> <span class="st">"Gibbs"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find required quantities</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>terms <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>topics <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> <span class="fu">colnames</span>(phi)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>doc_length <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(corpus)) {</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">paste</span>(corpus[[i]]<span class="sc">$</span>content, <span class="at">collapse =</span> <span class="st">' '</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  doc_length <span class="ot">&lt;-</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(doc_length, <span class="fu">stri_count</span>(temp, <span class="at">regex =</span> <span class="st">'</span><span class="sc">\\</span><span class="st">S+'</span>))</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>temp_frequency <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>freq_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ST =</span> <span class="fu">colnames</span>(temp_frequency),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Freq =</span> <span class="fu">colSums</span>(temp_frequency))</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to json</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>json_lda <span class="ot">&lt;-</span> LDAvis<span class="sc">::</span><span class="fu">createJSON</span>(</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> phi,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> theta,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab =</span> vocab,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">doc.length =</span> doc_length,</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">term.frequency =</span> freq_matrix<span class="sc">$</span>Freq</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Open server for visualization</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="fu">serVis</span>(json_lda, <span class="at">out.dir =</span> <span class="st">"../LDAvis"</span>, <span class="at">open.browser =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required namespace: servr</code></pre>
</div>
</div>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script src="./LDAvis/d3.v3.js"></script>
<script src="./LDAvis/ldavis.js"></script>
<p><link rel="stylesheet" type="text/css" href="./LDAvis/lda.css"></p>
<div id="lda">

</div>
<script>
    var vis = new LDAvis("#lda", "./LDAvis/lda.json");
  </script>
<p>To interpret this visualization we fist need to define several quantities:</p>
<p><em>Relevance</em> - Sievert and Shirley propose relevance as a metric to rank terms based on their usefulness for interpreting topics (2014). They define it as follows:</p>
<p><span class="math display">\[r(w,k|\lambda)=\lambda \text{log}(\phi_{kw}+(1-\lambda)\text{log}\left( \frac{\phi_{kw}}{p_w}\right)\]</span></p>
<ul>
<li><span class="math inline">\(\phi_{kw}\)</span>: the probability of term <span class="math inline">\(w\)</span> for topic <span class="math inline">\(k\)</span>.</li>
<li><span class="math inline">\(p_w\)</span>: the marginal probability of term <span class="math inline">\(w\)</span> in the corpus.</li>
<li><span class="math inline">\(\lambda\)</span>: a weight parameter such that <span class="math inline">\(0 \leq \lambda \leq 1\)</span>.</li>
<li><span class="math inline">\(\text{log}\left( \frac{\phi_{kw}}{p_w}\right)\)</span>: the lift of a term.</li>
</ul>
<p>A <span class="math inline">\(\lambda\)</span> of 1 orders terms based on their topic-specific probability whereas a <span class="math inline">\(\lambda\)</span> of 0 orders term based on their lift. Sievert and Shirley suggest <span class="math inline">\(\lambda = 6\)</span>. The higher this metric the better.</p>
<p><em>Lift</em> - As seen above Lift is the ratio of a term’s probability in a given topic to its marginal probability. The metric downweights terms that are frequent throughout an entire corpus (Sievert &amp; Shirley 2014).</p>
<p><em>Saliency</em> - Introuced by Chuang, Manning, and Heer, it is defined as follows (2012): <span class="math display">\[\begin{align} saliency(w) &amp;= P(W) \times distinctiveness(w) \\
distinctiveness(w) &amp;= \sum_T P(T|w)\text{log}\frac{P(T|w)}{P(T)}
\end{align}\]</span></p>
<ul>
<li><span class="math inline">\(P(T|w)\)</span>: the probability a word <span class="math inline">\(w\)</span> was genereted by a topic <span class="math inline">\(T\)</span></li>
<li><span class="math inline">\(P(T)\)</span>: the marginal probability of the topic, i.e., the probability a word was produced b topic <span class="math inline">\(T\)</span></li>
</ul>
<p>The general idea is that distinctiveness is the Kullback-Leibler divergence between <span class="math inline">\(P(T|w)\)</span> and <span class="math inline">\(P(T)\)</span> and informs us how useful a <span class="math inline">\(w\)</span> is for determining a generating topic. Multiplying this by <span class="math inline">\(P(w)\)</span> yields saliency; a metric that ranks terms in their usefulness in identifying topics.</p>
<p>With these we can understand our visuals:</p>
<ul>
<li><p>Topic circles: circles are drawn equal to the number of topics. Their areas are proportional to the estimated number of words produced by that topic. The centers of the circles are determined by computing the distances between topics which are then projected onto a 2D plane. The larger a circle is, the more prevalent it is.</p></li>
<li><p>Red Bars: the estimated number of times a term was created by a topic. When you select a circle (topic) the red bars for the most relevant terms will be highlighted.</p></li>
<li><p>Blue Bars: each bar represents the frequency of each term. When no topic is selected the blue bars for the most salient terms are displayed. When a topic is selected the blue bars are the frequency of the most relevant terms.</p></li>
<li><p>Topic-Term Circles: When you highlight a term the circles’ areas will change. These circles’ areas are proportional to the number of times a topic generated that specific term.</p></li>
</ul>
<p>If <span class="math inline">\(\lambda=1\)</span> terms are ranked in decreasing order of their topic-specific probability. <span class="math inline">\(\lambda=0\)</span> ranks terms solely by their lift. The optimal <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\lambda=0.6\)</span>.</p>
</section>
</section>
<section id="inspecting-beta" class="level3">
<h3 class="anchored" data-anchor-id="inspecting-beta">Inspecting <span class="math inline">\(\beta\)</span></h3>
<p>Given our optimal model we may now move onto exploring what words comprise each of the topics. To do so we first plot the terms with the highest <span class="math inline">\(\beta\)</span> values and then move onto wordclouds. Recall <span class="math inline">\(\beta\)</span> provides us with the per-topic-per-word probabilities. These are the probability a term was created by a topic.</p>
<div class="cell" data-hash="index_cache/html/Graph Beta University Level_c9eb169e82f9d65940fd37538afa414b">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>uni_topics <span class="ot">&lt;-</span> <span class="fu">tidy</span>(lda.out,<span class="at">matrix=</span><span class="st">"beta"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>top_terms <span class="ot">&lt;-</span> uni_topics <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">top_n</span>(<span class="dv">9</span>, beta) <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">arrange</span>(topic, <span class="sc">-</span>beta) <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder</span>(term, beta))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>top_terms <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(<span class="fu">aes</span>(term, beta, <span class="at">fill =</span> <span class="fu">factor</span>(topic))) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a> <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a> <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/Graph%20Beta%20University%20Level-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Examining word clouds may also prove fruitful.</p>
<div class="cell" data-hash="index_cache/html/wordcloud beta topics in university_cb52a4eb756d751badf9c43629bb0086">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">87460945</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>top_terms <span class="ot">&lt;-</span> uni_topics <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">top_n</span>(<span class="dv">20</span>, beta) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">arrange</span>(topic, <span class="sc">-</span>beta) <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder</span>(term, beta))</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:20) {</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># df &lt;- subset(as.data.frame(top_terms),topic==i)  </span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co"># wordcloud(df$term, freq = df$beta,colors= c("indianred1","indianred2","indianred3","indianred"))</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># title(paste("Topic ",i), font.main = 1)</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Topic 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Topic 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Topic 3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">Topic 4</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false" href="">Topic 5</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false" href="">Topic 6</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false" href="">Topic 7</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false" href="">Topic 8</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-9" role="tab" aria-controls="tabset-1-9" aria-selected="false" href="">Topic 9</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-10" role="tab" aria-controls="tabset-1-10" aria-selected="false" href="">Topic 10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-11-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-11" role="tab" aria-controls="tabset-1-11" aria-selected="false" href="">Topic 11</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-12-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-12" role="tab" aria-controls="tabset-1-12" aria-selected="false" href="">Topic 12</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-13-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-13" role="tab" aria-controls="tabset-1-13" aria-selected="false" href="">Topic 13</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-14-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-14" role="tab" aria-controls="tabset-1-14" aria-selected="false" href="">Topic 14</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-15-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-15" role="tab" aria-controls="tabset-1-15" aria-selected="false" href="">Topic 15</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-16-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-16" role="tab" aria-controls="tabset-1-16" aria-selected="false" href="">Topic 16</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-17-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-17" role="tab" aria-controls="tabset-1-17" aria-selected="false" href="">Topic 17</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-18-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-18" role="tab" aria-controls="tabset-1-18" aria-selected="false" href="">Topic 18</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-19-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-19" role="tab" aria-controls="tabset-1-19" aria-selected="false" href="">Topic 19</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-20-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-20" role="tab" aria-controls="tabset-1-20" aria-selected="false" href="">Topic 20</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-1_0ec8af73bf5eae7889329ba58547e2a2">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-2_d190ef4a45522b4fa8b36fb6fd5fdfb6">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-3_71197caec2f79705bcbde3a392e4530d">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-4_acaab0ece5715984c9f119d654c0b9f4">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-5_f33c3f03b1f4457048d95752fe2a7811">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-6_643bfe29aac618c63b384c6851a5c72a">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-7_c12ac629befb4e20e649a20f7edd6138">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-8_600934c20ef901326d8c37c0fcb7e100">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-9-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-9_4f803d76c19eae6dee0943c6775ecb62">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-10-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-10_b14a6dd4373934bcc359056b65ed8e55">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-11" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-11-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-11_58733a886373f3b388c6d88ab71c6290">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-12" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-12-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-12_b92709ee6cd2ee4234e4f23d185cefdb">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-13" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-13-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-13_d76fe9c205946bd331572f2d8d52efe9">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-14" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-14-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-14_466d207cbcbe01136d0e61c161877d10">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-15" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-15-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-15_3b32629f4d2d94da3b54695a874fcb04">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-16" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-16-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-16_6e34dae496ae192e35a8142e33cd4f92">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-17" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-17-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-17_6bc5743d1a1af5fa67c4198a36ada62e">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-18" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-18-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-18_890377021b00ee6dff58a0a53d6f3c18">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-19" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-19-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-19_b9a971d07d2e00a7336ce8e9ff5fa22a">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-20" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-20-tab">
<div class="cell" data-hash="index_cache/html/unnamed-chunk-20_a5a462cd06c99debd32c46317a3d5e45">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="inspecting-gamma" class="level3">
<h3 class="anchored" data-anchor-id="inspecting-gamma">Inspecting <span class="math inline">\(\gamma\)</span></h3>
<p>Another interesting question to explore is which topics do universities prioritize? Is one university’s Data Science program more heavily biased towards Math? How about Statistics? Recall the <span class="math inline">\(\gamma\)</span> matrix provides us with the per-document-per-topic probabilities. That is, it provides us with a percentage break down of which topics generated each document.</p>
<div class="cell" data-hash="index_cache/html/Graph Gamma University Level_dee4af2b23eed7bf19063c1c842b5fd9">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>uni_topics <span class="ot">&lt;-</span> <span class="fu">tidy</span>(lda.out,<span class="at">matrix=</span><span class="st">"gamma"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>top_terms <span class="ot">&lt;-</span> uni_topics <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">arrange</span>(topic, gamma)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>top_terms <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">topic =</span> <span class="fu">reorder</span>(topic, gamma)) <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(<span class="fu">aes</span>(topic, gamma, <span class="at">fill =</span> <span class="fu">factor</span>(document))) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a> <span class="fu">facet_wrap</span>(<span class="sc">~</span> document, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/Graph%20Gamma%20University%20Level-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
</section>
<section id="inspecting-other-solutions" class="level2">
<h2 class="anchored" data-anchor-id="inspecting-other-solutions">Inspecting Other Solutions</h2>
<p>From our 20 group visualization we see significant overlap on the left clusters. This suggests one of our fewer topic solutions may be more apt. Therefore we opt to visualize the 5, 8, and 10 group solutions. Furthermore, it seems in our word clouds stemming has made interpretability more difficult. Therefore we change our DTM to not include stemming; if similair rooted words appear we can always go back and combine them by hand.</p>
<div class="cell" data-hash="index_cache/html/Remaking DTM_eeda4814c126abf304a20d552dc29243">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading in data</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../data/RObjects/degree_corpus.RData"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct corpus object</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">DataframeSource</span>(degree_corpus)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(ds)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Text preprocessing omitting stemming</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove punctuation</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(removePunctuation))</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Send everything to lower case</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(tolower))</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove stopwords</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(removeWords), </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove whitespace</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, stripWhitespace)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove numbers</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(removeNumbers))</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove custom stop words</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>remove_words <span class="ot">&lt;-</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"include"</span>,<span class="st">"methods"</span>,<span class="st">"topics"</span>,<span class="st">"design"</span>,<span class="st">"functions"</span>,<span class="st">"emphasis"</span>,<span class="st">"language"</span>,<span class="st">"introduction"</span>,<span class="st">"languages"</span>,<span class="st">"performance"</span>,<span class="st">"experience"</span>,<span class="st">"course"</span>,<span class="st">"science"</span>,<span class="st">"techniques"</span>,<span class="st">"variables"</span>,<span class="st">"number"</span>,<span class="st">"department"</span>,<span class="st">"tools"</span>,<span class="st">"fundamental"</span>,<span class="st">"also"</span>,<span class="st">"major"</span>,<span class="st">"modern"</span>,<span class="st">"issues"</span>,<span class="st">"used"</span>,<span class="st">"methods"</span>,<span class="st">"using"</span>,<span class="st">"case"</span>,<span class="st">"architecture"</span>,<span class="st">"covered"</span>,<span class="st">"credit"</span>,<span class="st">"basic"</span>,<span class="st">"cosc"</span>,<span class="st">"granted"</span>,<span class="st">"use"</span>,<span class="st">"solutions"</span>,<span class="st">"data"</span>,<span class="st">"will"</span>,<span class="st">"students"</span>,<span class="st">"fall"</span>,<span class="st">"spring"</span>,<span class="st">"important"</span>,<span class="st">"one"</span>,<span class="st">"considered"</span>,<span class="st">"stacks"</span>,<span class="st">"offers"</span>,<span class="st">"types"</span>,<span class="st">"may"</span>,<span class="st">"held"</span>,<span class="st">"former"</span>,<span class="st">"honours"</span>,<span class="st">"faculty"</span>,<span class="st">"related"</span>,<span class="st">"enter"</span>,<span class="st">"review"</span>,<span class="st">"enrolment"</span>,<span class="st">"exercises"</span>,<span class="st">"summer"</span>,<span class="st">"need"</span>,<span class="st">"offered"</span>,<span class="st">"social"</span>,<span class="st">"digital"</span>,<span class="st">"terms"</span>,<span class="st">"real"</span>,<span class="st">"concepts"</span>,<span class="st">"understanding"</span>,<span class="st">"can"</span>,<span class="st">"including"</span>,<span class="st">"programs"</span>,<span class="st">"program"</span>,<span class="st">"recommended"</span>,<span class="st">"examples"</span>,<span class="st">"introduced"</span>,<span class="st">"large"</span>,<span class="st">"search"</span>,<span class="st">"relations"</span>,<span class="st">"key"</span>,<span class="st">"etc"</span>,<span class="st">"reasoning"</span>,<span class="st">"intended"</span>,<span class="st">"fws"</span>,<span class="st">"general"</span>,<span class="st">"restricted"</span>,<span class="st">"version"</span>,<span class="st">"two"</span>,<span class="st">"comp"</span>,<span class="st">"well"</span>,<span class="st">"rich"</span>,<span class="st">"intended"</span>,<span class="st">"required"</span>,<span class="st">"internet"</span>,<span class="st">"recent"</span>,<span class="st">"phys"</span>,<span class="st">"sciences"</span>,<span class="st">"covers"</span>,<span class="st">"year"</span>,<span class="st">"selected"</span>,<span class="st">"renewal"</span>,<span class="st">"explored"</span>,<span class="st">"csch"</span>,<span class="st">"principles"</span>,<span class="st">"practice"</span>,<span class="st">"development"</span>,<span class="st">"studies"</span>,<span class="st">"security"</span>,<span class="st">"provides"</span>,<span class="st">"advanced"</span>,<span class="st">"instruction"</span>,<span class="st">"discussed"</span>,<span class="st">"processes"</span>,<span class="st">"death"</span>,<span class="st">"lower"</span>,<span class="st">"high"</span>,<span class="st">"crncr"</span>,<span class="st">"taken"</span>,<span class="st">"efficient"</span>,<span class="st">"includes"</span>,<span class="st">"core"</span>,<span class="st">"retrieval"</span>,<span class="st">"class"</span>,<span class="st">"within"</span>,<span class="st">"present"</span>,<span class="st">"option"</span>,<span class="st">"interested"</span>,<span class="st">"together"</span>,<span class="st">"session"</span>,<span class="st">"week"</span>,<span class="st">"new"</span>,<span class="st">"order"</span>,<span class="st">"tables"</span>,<span class="st">"small"</span>,<span class="st">"suitable"</span>,<span class="st">"wide"</span>,<span class="st">"without"</span>,<span class="st">"good"</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="cf">function</span>(x) {</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">removeWords</span>(x, remove_words)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DTM</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> <span class="fu">DocumentTermMatrix</span>(corpus)</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(dtm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;DocumentTermMatrix (documents: 9, terms: 1859)&gt;&gt;
Non-/sparse entries: 3546/13185
Sparsity           : 79%
Maximal term length: 63
Weighting          : term frequency (tf)
Sample             :
           Terms
Docs        algorithms analysis applications linear math models programming
  Berkeley           2        3            3      4    1      1           6
  Concordia          5        7            6      7    1      6           9
  Laurier           11       14            6      7    0      5           7
  Manitoba           4       11            4      4   45      3           5
  SFU                7       16            6      5    8      8          15
  Toronto            7        9            2      3    0      5           8
  UBCO               1        7            9      6    5      8           1
  Waterloo          12        5            7      5    0      5           6
  Western            7        2            2      4    0      6           4
           Terms
Docs        regression statistical systems
  Berkeley           4           3       5
  Concordia          4           5       6
  Laurier            4           2       8
  Manitoba           6           5       6
  SFU                5           3      10
  Toronto            6          15       1
  UBCO               3           7       4
  Waterloo          10           3       7
  Western            4           2       4</code></pre>
</div>
</div>
<div class="cell" data-hash="index_cache/html/TF-IDF weighting 2_26de8c44f61895a18e8b7cc248e24154">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reweight and filter DTM based on mean TF-IDF</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>tfidf_dtm <span class="ot">&lt;-</span> <span class="fu">weightTfIdf</span>(dtm)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>tfidf_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tfidf_dtm)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(tfidf_mat[tfidf_mat <span class="sc">&gt;</span> <span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003326259</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>tfidf_dtm_r <span class="ot">&lt;-</span> tfidf_dtm[,tfidf_dtm<span class="sc">$</span>v <span class="sc">&gt;</span> <span class="fl">0.0033</span>]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get our list of tfidf terms       </span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> tfidf_dtm_r<span class="sc">$</span>dimnames<span class="sc">$</span>Terms</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter our original dtm</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> dtm[,<span class="fu">which</span>(dtm<span class="sc">$</span>dimnames<span class="sc">$</span>Terms <span class="sc">%in%</span> terms)]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(dtm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;DocumentTermMatrix (documents: 9, terms: 907)&gt;&gt;
Non-/sparse entries: 1764/6399
Sparsity           : 78%
Maximal term length: 63
Weighting          : term frequency (tf)
Sample             :
           Terms
Docs        applications database learning linear math model programming
  Berkeley             3        0        0      4    1     2           6
  Concordia            6        3        3      7    1     5           9
  Laurier              6        2       12      7    0     5           7
  Manitoba             4        1        3      4   45     2           5
  SFU                  6        6        3      5    8     2          15
  Toronto              2        3        3      3    0     1           8
  UBCO                 9        1        2      6    5     3           1
  Waterloo             7       11        9      5    0     2           6
  Western              2        3        2      4    0     4           4
           Terms
Docs        regression statistics structures
  Berkeley           4          0          4
  Concordia          4          1          2
  Laurier            4          2          3
  Manitoba           6         14          1
  SFU                5          6          4
  Toronto            6          0          2
  UBCO               3          2          3
  Waterloo          10          1          4
  Western            4          1          2</code></pre>
</div>
</div>
<section id="group-solution" class="level3">
<h3 class="anchored" data-anchor-id="group-solution">5 Group Solution</h3>
<div class="cell" data-hash="index_cache/html/5 groups vis median tf-idf_d385f7320dfd5471aeea482deb9bb51d">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit largest model</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>lda.out <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm, <span class="dv">5</span>, <span class="at">method =</span> <span class="st">"Gibbs"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find required quantities</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>terms <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>topics <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> <span class="fu">colnames</span>(phi)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>doc_length <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(corpus)) {</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">paste</span>(corpus[[i]]<span class="sc">$</span>content, <span class="at">collapse =</span> <span class="st">' '</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  doc_length <span class="ot">&lt;-</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(doc_length, <span class="fu">stri_count</span>(temp, <span class="at">regex =</span> <span class="st">'</span><span class="sc">\\</span><span class="st">S+'</span>))</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>temp_frequency <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>freq_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ST =</span> <span class="fu">colnames</span>(temp_frequency),</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Freq =</span> <span class="fu">colSums</span>(temp_frequency))</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to json</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>json_lda <span class="ot">&lt;-</span> LDAvis<span class="sc">::</span><span class="fu">createJSON</span>(</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> phi,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> theta,</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab =</span> vocab,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">doc.length =</span> doc_length,</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">term.frequency =</span> freq_matrix<span class="sc">$</span>Freq</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Open server for visualization</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="co"># serVis(json_lda, open.browser = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="group-solution-1" class="level3">
<h3 class="anchored" data-anchor-id="group-solution-1">8 Group Solution</h3>
<div class="cell" data-hash="index_cache/html/8 groups vis median tf-idf_dd9880b7d81cda124b4dac953ba4ca58">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit largest model</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>lda.out <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm, <span class="dv">8</span>, <span class="at">method =</span> <span class="st">"Gibbs"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find required quantities</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>terms <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>topics <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> <span class="fu">colnames</span>(phi)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>doc_length <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(corpus)) {</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">paste</span>(corpus[[i]]<span class="sc">$</span>content, <span class="at">collapse =</span> <span class="st">' '</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  doc_length <span class="ot">&lt;-</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(doc_length, <span class="fu">stri_count</span>(temp, <span class="at">regex =</span> <span class="st">'</span><span class="sc">\\</span><span class="st">S+'</span>))</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>temp_frequency <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>freq_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ST =</span> <span class="fu">colnames</span>(temp_frequency),</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Freq =</span> <span class="fu">colSums</span>(temp_frequency))</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to json</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>json_lda <span class="ot">&lt;-</span> LDAvis<span class="sc">::</span><span class="fu">createJSON</span>(</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> phi,</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> theta,</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab =</span> vocab,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">doc.length =</span> doc_length,</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">term.frequency =</span> freq_matrix<span class="sc">$</span>Freq</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Open server for visualization</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="co"># serVis(json_lda, open.browser = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="group-solution-2" class="level3">
<h3 class="anchored" data-anchor-id="group-solution-2">10 Group Solution</h3>
<div class="cell" data-hash="index_cache/html/10 groups vis median tf-idf_6f8cf1afc76f5618bc6335777b13d6ad">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit largest model</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>lda.out <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm, <span class="dv">10</span>, <span class="at">method =</span> <span class="st">"Gibbs"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find required quantities</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>terms <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>topics <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> <span class="fu">colnames</span>(phi)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>doc_length <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(corpus)) {</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">paste</span>(corpus[[i]]<span class="sc">$</span>content, <span class="at">collapse =</span> <span class="st">' '</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  doc_length <span class="ot">&lt;-</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(doc_length, <span class="fu">stri_count</span>(temp, <span class="at">regex =</span> <span class="st">'</span><span class="sc">\\</span><span class="st">S+'</span>))</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>temp_frequency <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>freq_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ST =</span> <span class="fu">colnames</span>(temp_frequency),</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Freq =</span> <span class="fu">colSums</span>(temp_frequency))</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to json</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>json_lda <span class="ot">&lt;-</span> LDAvis<span class="sc">::</span><span class="fu">createJSON</span>(</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> phi,</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> theta,</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab =</span> vocab,</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">doc.length =</span> doc_length,</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">term.frequency =</span> freq_matrix<span class="sc">$</span>Freq</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Open server for visualization</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="co"># serVis(json_lda, open.browser = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="work-in-progress" class="level2">
<h2 class="anchored" data-anchor-id="work-in-progress">Work in progress</h2>
<p>Going to explore cutting TF-IDF at the 25th percentile and no TF-IDF filtering for the 5, 8, and 10 group solutions</p>
<section id="no-tf-idf" class="level3">
<h3 class="anchored" data-anchor-id="no-tf-idf">No TF-IDF</h3>
<div class="cell" data-hash="index_cache/html/Setting up unfiltered dtm_6f0722ff31329f9e51c93ca16c45316d">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading in data</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../data/RObjects/degree_corpus.RData"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create corpus object</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">DataframeSource</span>(degree_corpus)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(ds)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove punctuation</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(removePunctuation))</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Send everything to lower case</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(tolower))</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove stopwords</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">content_transformer</span>(removeWords),</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove whitespace</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, stripWhitespace)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove numbers</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(removeNumbers))</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove custom stop words</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>remove_words <span class="ot">&lt;-</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"include"</span>,<span class="st">"methods"</span>,<span class="st">"topics"</span>,<span class="st">"design"</span>,<span class="st">"functions"</span>,<span class="st">"emphasis"</span>,<span class="st">"language"</span>,<span class="st">"introduction"</span>,<span class="st">"languages"</span>,<span class="st">"performance"</span>,<span class="st">"experience"</span>,<span class="st">"course"</span>,<span class="st">"science"</span>,<span class="st">"techniques"</span>,<span class="st">"variables"</span>,<span class="st">"number"</span>,<span class="st">"department"</span>,<span class="st">"tools"</span>,<span class="st">"fundamental"</span>,<span class="st">"also"</span>,<span class="st">"major"</span>,<span class="st">"modern"</span>,<span class="st">"issues"</span>,<span class="st">"used"</span>,<span class="st">"methods"</span>,<span class="st">"using"</span>,<span class="st">"case"</span>,<span class="st">"architecture"</span>,<span class="st">"covered"</span>,<span class="st">"credit"</span>,<span class="st">"basic"</span>,<span class="st">"cosc"</span>,<span class="st">"granted"</span>,<span class="st">"use"</span>,<span class="st">"solutions"</span>,<span class="st">"data"</span>,<span class="st">"will"</span>,<span class="st">"students"</span>,<span class="st">"fall"</span>,<span class="st">"spring"</span>,<span class="st">"important"</span>,<span class="st">"one"</span>,<span class="st">"considered"</span>,<span class="st">"stacks"</span>,<span class="st">"offers"</span>,<span class="st">"types"</span>,<span class="st">"may"</span>,<span class="st">"held"</span>,<span class="st">"former"</span>,<span class="st">"honours"</span>,<span class="st">"faculty"</span>,<span class="st">"related"</span>,<span class="st">"enter"</span>,<span class="st">"review"</span>,<span class="st">"enrolment"</span>,<span class="st">"exercises"</span>,<span class="st">"summer"</span>,<span class="st">"need"</span>,<span class="st">"offered"</span>,<span class="st">"social"</span>,<span class="st">"digital"</span>,<span class="st">"terms"</span>,<span class="st">"real"</span>,<span class="st">"concepts"</span>,<span class="st">"understanding"</span>,<span class="st">"can"</span>,<span class="st">"including"</span>,<span class="st">"programs"</span>,<span class="st">"program"</span>,<span class="st">"recommended"</span>,<span class="st">"examples"</span>,<span class="st">"introduced"</span>,<span class="st">"large"</span>,<span class="st">"search"</span>,<span class="st">"relations"</span>,<span class="st">"key"</span>,<span class="st">"etc"</span>,<span class="st">"reasoning"</span>,<span class="st">"intended"</span>,<span class="st">"fws"</span>,<span class="st">"general"</span>,<span class="st">"restricted"</span>,<span class="st">"version"</span>,<span class="st">"two"</span>,<span class="st">"comp"</span>,<span class="st">"well"</span>,<span class="st">"rich"</span>,<span class="st">"intended"</span>,<span class="st">"required"</span>,<span class="st">"internet"</span>,<span class="st">"recent"</span>,<span class="st">"phys"</span>,<span class="st">"sciences"</span>,<span class="st">"covers"</span>,<span class="st">"year"</span>,<span class="st">"selected"</span>,<span class="st">"renewal"</span>,<span class="st">"explored"</span>,<span class="st">"csch"</span>,<span class="st">"principles"</span>,<span class="st">"practice"</span>,<span class="st">"development"</span>,<span class="st">"studies"</span>,<span class="st">"security"</span>,<span class="st">"provides"</span>,<span class="st">"advanced"</span>,<span class="st">"instruction"</span>,<span class="st">"discussed"</span>,<span class="st">"processes"</span>,<span class="st">"death"</span>,<span class="st">"lower"</span>,<span class="st">"high"</span>,<span class="st">"crncr"</span>,<span class="st">"taken"</span>,<span class="st">"efficient"</span>,<span class="st">"includes"</span>,<span class="st">"core"</span>,<span class="st">"retrieval"</span>,<span class="st">"class"</span>,<span class="st">"within"</span>,<span class="st">"present"</span>,<span class="st">"option"</span>,<span class="st">"interested"</span>,<span class="st">"together"</span>,<span class="st">"session"</span>,<span class="st">"week"</span>,<span class="st">"new"</span>,<span class="st">"order"</span>,<span class="st">"tables"</span>,<span class="st">"small"</span>,<span class="st">"suitable"</span>,<span class="st">"wide"</span>,<span class="st">"without"</span>,<span class="st">"good"</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="cf">function</span>(x) {</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">removeWords</span>(x, remove_words)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>dtm_notfidf <span class="ot">&lt;-</span> <span class="fu">DocumentTermMatrix</span>(corpus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Not stemming means we will manually have to combine like terms. For example our corpus contains “math”, “mathematics”, “mathematically”, and “mathematical” so we will need to go in and sum their columns in the DTM.</p>
<div class="cell" data-hash="index_cache/html/Combining Math Columns_f6235e24df393af43176a039f03e9ca4">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get indices of math columns</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>math_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(dtm_notfidf) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"math"</span>, <span class="st">"mathematics"</span>, <span class="st">"mathematically"</span>,<span class="st">"mathematical"</span>))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert sparse matrix dtm to normal matrix</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>dtm_notfidf <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm_notfidf)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine columns that mean math</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>dtm_notfidf[,<span class="fu">c</span>(math_idx[<span class="dv">4</span>])] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(dtm_notfidf[,<span class="fu">c</span>(math_idx)])</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>dtm_notfidf <span class="ot">&lt;-</span> dtm_notfidf[,<span class="sc">-</span>math_idx[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]]</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert back to DTM</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>dtm_notfidf <span class="ot">&lt;-</span> <span class="fu">as.DocumentTermMatrix</span>(<span class="fu">as.simple_triplet_matrix</span>(dtm_notfidf),<span class="at">weighting =</span> weightTf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="group-solution-3" class="level4">
<h4 class="anchored" data-anchor-id="group-solution-3">5 Group Solution</h4>
<div class="cell" data-hash="index_cache/html/5 Group No TF-IDF Weighting Vis_08255ba262e1b4f049046307d8610f3e">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit largest model</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>lda.out <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm_notfidf, <span class="dv">5</span>, <span class="at">method =</span> <span class="st">"Gibbs"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find required quantities</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>terms <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>topics <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> <span class="fu">colnames</span>(phi)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>doc_length <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(corpus)) {</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">paste</span>(corpus[[i]]<span class="sc">$</span>content, <span class="at">collapse =</span> <span class="st">' '</span>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  doc_length <span class="ot">&lt;-</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(doc_length, <span class="fu">stri_count</span>(temp, <span class="at">regex =</span> <span class="st">'</span><span class="sc">\\</span><span class="st">S+'</span>))</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>temp_frequency <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm_notfidf)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>freq_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ST =</span> <span class="fu">colnames</span>(temp_frequency),</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Freq =</span> <span class="fu">colSums</span>(temp_frequency))</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to json</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>json_lda <span class="ot">&lt;-</span> LDAvis<span class="sc">::</span><span class="fu">createJSON</span>(</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> phi,</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> theta,</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab =</span> vocab,</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">doc.length =</span> doc_length,</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">term.frequency =</span> freq_matrix<span class="sc">$</span>Freq</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Open server for visualization</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="co"># serVis(json_lda, open.browser = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="group-solution-4" class="level4">
<h4 class="anchored" data-anchor-id="group-solution-4">8 Group Solution</h4>
<div class="cell" data-hash="index_cache/html/8 Group No TF-IDF Weighting Vis_dff8f3f9c70506e73bb4aad109c9b526">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit largest model</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>lda.out <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm_notfidf, <span class="dv">8</span>, <span class="at">method =</span> <span class="st">"Gibbs"</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find required quantities</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>terms <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>topics <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> <span class="fu">colnames</span>(phi)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>doc_length <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(corpus)) {</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">paste</span>(corpus[[i]]<span class="sc">$</span>content, <span class="at">collapse =</span> <span class="st">' '</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  doc_length <span class="ot">&lt;-</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(doc_length, <span class="fu">stri_count</span>(temp, <span class="at">regex =</span> <span class="st">'</span><span class="sc">\\</span><span class="st">S+'</span>))</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>temp_frequency <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm_notfidf)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>freq_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ST =</span> <span class="fu">colnames</span>(temp_frequency),</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Freq =</span> <span class="fu">colSums</span>(temp_frequency))</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to json</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>json_lda <span class="ot">&lt;-</span> LDAvis<span class="sc">::</span><span class="fu">createJSON</span>(</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> phi,</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> theta,</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab =</span> vocab,</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">doc.length =</span> doc_length,</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">term.frequency =</span> freq_matrix<span class="sc">$</span>Freq</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Open server for visualization</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a><span class="co"># serVis(json_lda, open.browser = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="group-solution-5" class="level4">
<h4 class="anchored" data-anchor-id="group-solution-5">10 Group Solution</h4>
<div class="cell" data-hash="index_cache/html/10 Group No TF-IDF Weighting Vis_023e0528bf5854449734f14648f782d6">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit largest model</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>lda.out <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm_notfidf, <span class="dv">10</span>, <span class="at">method =</span> <span class="st">"Gibbs"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find required quantities</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>terms <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>topics <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> <span class="fu">colnames</span>(phi)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>doc_length <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(corpus)) {</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">paste</span>(corpus[[i]]<span class="sc">$</span>content, <span class="at">collapse =</span> <span class="st">' '</span>)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  doc_length <span class="ot">&lt;-</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(doc_length, <span class="fu">stri_count</span>(temp, <span class="at">regex =</span> <span class="st">'</span><span class="sc">\\</span><span class="st">S+'</span>))</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>temp_frequency <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm_notfidf)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>freq_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ST =</span> <span class="fu">colnames</span>(temp_frequency),</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Freq =</span> <span class="fu">colSums</span>(temp_frequency))</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to json</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>json_lda <span class="ot">&lt;-</span> LDAvis<span class="sc">::</span><span class="fu">createJSON</span>(</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> phi,</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> theta,</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab =</span> vocab,</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">doc.length =</span> doc_length,</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">term.frequency =</span> freq_matrix<span class="sc">$</span>Freq</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Open server for visualization</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="co"># serVis(json_lda, open.browser = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="tf-idf-25th-percentile" class="level3">
<h3 class="anchored" data-anchor-id="tf-idf-25th-percentile">TF-IDF 25th Percentile</h3>
<div class="cell" data-hash="index_cache/html/Remaking DTM for TF-IDF 25th Percentile_60ca6ed793d8ab31496e5c86a8cb460d">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading in data</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../data/RObjects/degree_corpus.RData"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct corpus object</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">DataframeSource</span>(degree_corpus)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(ds)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Text preprocessing omitting stemming</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove punctuation</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(removePunctuation))</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Send everything to lower case</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(tolower))</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove stopwords</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(removeWords), </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove whitespace</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, stripWhitespace)</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove numbers</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(removeNumbers))</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove custom stop words</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>remove_words <span class="ot">&lt;-</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"include"</span>,<span class="st">"methods"</span>,<span class="st">"topics"</span>,<span class="st">"design"</span>,<span class="st">"functions"</span>,<span class="st">"emphasis"</span>,<span class="st">"language"</span>,<span class="st">"introduction"</span>,<span class="st">"languages"</span>,<span class="st">"performance"</span>,<span class="st">"experience"</span>,<span class="st">"course"</span>,<span class="st">"science"</span>,<span class="st">"techniques"</span>,<span class="st">"variables"</span>,<span class="st">"number"</span>,<span class="st">"department"</span>,<span class="st">"tools"</span>,<span class="st">"fundamental"</span>,<span class="st">"also"</span>,<span class="st">"major"</span>,<span class="st">"modern"</span>,<span class="st">"issues"</span>,<span class="st">"used"</span>,<span class="st">"methods"</span>,<span class="st">"using"</span>,<span class="st">"case"</span>,<span class="st">"architecture"</span>,<span class="st">"covered"</span>,<span class="st">"credit"</span>,<span class="st">"basic"</span>,<span class="st">"cosc"</span>,<span class="st">"granted"</span>,<span class="st">"use"</span>,<span class="st">"solutions"</span>,<span class="st">"data"</span>,<span class="st">"will"</span>,<span class="st">"students"</span>,<span class="st">"fall"</span>,<span class="st">"spring"</span>,<span class="st">"important"</span>,<span class="st">"one"</span>,<span class="st">"considered"</span>,<span class="st">"stacks"</span>,<span class="st">"offers"</span>,<span class="st">"types"</span>,<span class="st">"may"</span>,<span class="st">"held"</span>,<span class="st">"former"</span>,<span class="st">"honours"</span>,<span class="st">"faculty"</span>,<span class="st">"related"</span>,<span class="st">"enter"</span>,<span class="st">"review"</span>,<span class="st">"enrolment"</span>,<span class="st">"exercises"</span>,<span class="st">"summer"</span>,<span class="st">"need"</span>,<span class="st">"offered"</span>,<span class="st">"social"</span>,<span class="st">"digital"</span>,<span class="st">"terms"</span>,<span class="st">"real"</span>,<span class="st">"concepts"</span>,<span class="st">"understanding"</span>,<span class="st">"can"</span>,<span class="st">"including"</span>,<span class="st">"programs"</span>,<span class="st">"program"</span>,<span class="st">"recommended"</span>,<span class="st">"examples"</span>,<span class="st">"introduced"</span>,<span class="st">"large"</span>,<span class="st">"search"</span>,<span class="st">"relations"</span>,<span class="st">"key"</span>,<span class="st">"etc"</span>,<span class="st">"reasoning"</span>,<span class="st">"intended"</span>,<span class="st">"fws"</span>,<span class="st">"general"</span>,<span class="st">"restricted"</span>,<span class="st">"version"</span>,<span class="st">"two"</span>,<span class="st">"comp"</span>,<span class="st">"well"</span>,<span class="st">"rich"</span>,<span class="st">"intended"</span>,<span class="st">"required"</span>,<span class="st">"internet"</span>,<span class="st">"recent"</span>,<span class="st">"phys"</span>,<span class="st">"sciences"</span>,<span class="st">"covers"</span>,<span class="st">"year"</span>,<span class="st">"selected"</span>,<span class="st">"renewal"</span>,<span class="st">"explored"</span>,<span class="st">"csch"</span>,<span class="st">"principles"</span>,<span class="st">"practice"</span>,<span class="st">"development"</span>,<span class="st">"studies"</span>,<span class="st">"security"</span>,<span class="st">"provides"</span>,<span class="st">"advanced"</span>,<span class="st">"instruction"</span>,<span class="st">"discussed"</span>,<span class="st">"processes"</span>,<span class="st">"death"</span>,<span class="st">"lower"</span>,<span class="st">"high"</span>,<span class="st">"crncr"</span>,<span class="st">"taken"</span>,<span class="st">"efficient"</span>,<span class="st">"includes"</span>,<span class="st">"core"</span>,<span class="st">"retrieval"</span>,<span class="st">"class"</span>,<span class="st">"within"</span>,<span class="st">"present"</span>,<span class="st">"option"</span>,<span class="st">"interested"</span>,<span class="st">"together"</span>,<span class="st">"session"</span>,<span class="st">"week"</span>,<span class="st">"new"</span>,<span class="st">"order"</span>,<span class="st">"tables"</span>,<span class="st">"small"</span>,<span class="st">"suitable"</span>,<span class="st">"wide"</span>,<span class="st">"without"</span>,<span class="st">"good"</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="cf">function</span>(x) {</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">removeWords</span>(x, remove_words)</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DTM</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>dtm_25tfidf <span class="ot">&lt;-</span> <span class="fu">DocumentTermMatrix</span>(corpus)</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(dtm_25tfidf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;DocumentTermMatrix (documents: 9, terms: 1859)&gt;&gt;
Non-/sparse entries: 3546/13185
Sparsity           : 79%
Maximal term length: 63
Weighting          : term frequency (tf)
Sample             :
           Terms
Docs        algorithms analysis applications linear math models programming
  Berkeley           2        3            3      4    1      1           6
  Concordia          5        7            6      7    1      6           9
  Laurier           11       14            6      7    0      5           7
  Manitoba           4       11            4      4   45      3           5
  SFU                7       16            6      5    8      8          15
  Toronto            7        9            2      3    0      5           8
  UBCO               1        7            9      6    5      8           1
  Waterloo          12        5            7      5    0      5           6
  Western            7        2            2      4    0      6           4
           Terms
Docs        regression statistical systems
  Berkeley           4           3       5
  Concordia          4           5       6
  Laurier            4           2       8
  Manitoba           6           5       6
  SFU                5           3      10
  Toronto            6          15       1
  UBCO               3           7       4
  Waterloo          10           3       7
  Western            4           2       4</code></pre>
</div>
</div>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-21_7e3a30edb4323775af0bd6cc44fa42dd">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get indices of math columns</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>math_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(dtm_25tfidf) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"math"</span>, <span class="st">"mathematics"</span>, <span class="st">"mathematically"</span>,<span class="st">"mathematical"</span>))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert sparse matrix dtm to normal matrix</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>dtm_25tfidf <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm_25tfidf)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine columns that mean math</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>dtm_25tfidf[,<span class="fu">c</span>(math_idx[<span class="dv">4</span>])] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(dtm_25tfidf[,<span class="fu">c</span>(math_idx)])</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>dtm_25tfidf <span class="ot">&lt;-</span> dtm_25tfidf[,<span class="sc">-</span>math_idx[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]]</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert back to DTM</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>dtm_25tfidf <span class="ot">&lt;-</span> <span class="fu">as.DocumentTermMatrix</span>(<span class="fu">as.simple_triplet_matrix</span>(dtm_25tfidf),<span class="at">weighting =</span> weightTf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="index_cache/html/TF-IDF weighting for 25th pt 1_ffa708360296d4ae7fb073b29a7edb0b">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reweight and filter DTM based on mean TF-IDF</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>tfidf_dtm <span class="ot">&lt;-</span> <span class="fu">weightTfIdf</span>(dtm_25tfidf)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>tfidf_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tfidf_dtm)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tfidf_mat[tfidf_mat <span class="sc">&gt;</span> <span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
0.0001783 0.0020241 0.0033263 0.0039243 0.0048575 0.0415728 </code></pre>
</div>
</div>
<div class="cell" data-hash="index_cache/html/TF-IDF weighting for 25th pt 2_5695cfd4aeea76cb974ed0e6b073a396">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>tfidf_dtm_r <span class="ot">&lt;-</span> tfidf_dtm[,tfidf_dtm<span class="sc">$</span>v <span class="sc">&gt;</span> <span class="fl">0.0020</span>]</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get our list of tfidf terms       </span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> tfidf_dtm_r<span class="sc">$</span>dimnames<span class="sc">$</span>Terms</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter our original dtm</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>dtm_25tfidf <span class="ot">&lt;-</span> dtm_25tfidf[,<span class="fu">which</span>(dtm<span class="sc">$</span>dimnames<span class="sc">$</span>Terms <span class="sc">%in%</span> terms)]</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(dtm_25tfidf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;DocumentTermMatrix (documents: 9, terms: 542)&gt;&gt;
Non-/sparse entries: 1359/3519
Sparsity           : 72%
Maximal term length: 63
Weighting          : term frequency (tf)
Sample             :
           Terms
Docs        algorithms computer database model probability regression software
  Berkeley           2        2        0     2           1          4        1
  Concordia          5        3        3     5           2          4        5
  Laurier           11        5        2     5           3          4        3
  Manitoba           4        3        1     2           4          6        3
  SFU                7        6        6     2           1          5        5
  Toronto            7        5        3     1           2          6        5
  UBCO               1        1        1     3           2          3        5
  Waterloo          12        6       11     2           6         10        4
  Western            7        1        3     4           2          4        4
           Terms
Docs        statistical systems theory
  Berkeley            3       5      2
  Concordia           5       6      2
  Laurier             2       8      4
  Manitoba            5       6      8
  SFU                 3      10      6
  Toronto            15       1      3
  UBCO                7       4      4
  Waterloo            3       7      4
  Western             2       4      3</code></pre>
</div>
</div>
<section id="group-solution-6" class="level4">
<h4 class="anchored" data-anchor-id="group-solution-6">5 Group Solution</h4>
<div class="cell" data-hash="index_cache/html/5 Group TF-IDF Weighting Vis_c254c16135bc8d58ee27e8f648822e8e">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit largest model</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>lda.out <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm_25tfidf, <span class="dv">5</span>, <span class="at">method =</span> <span class="st">"Gibbs"</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find required quantities</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>terms <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>topics <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> <span class="fu">colnames</span>(phi)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>doc_length <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(corpus)) {</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">paste</span>(corpus[[i]]<span class="sc">$</span>content, <span class="at">collapse =</span> <span class="st">' '</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  doc_length <span class="ot">&lt;-</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(doc_length, <span class="fu">stri_count</span>(temp, <span class="at">regex =</span> <span class="st">'</span><span class="sc">\\</span><span class="st">S+'</span>))</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>temp_frequency <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm_25tfidf)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>freq_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ST =</span> <span class="fu">colnames</span>(temp_frequency),</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Freq =</span> <span class="fu">colSums</span>(temp_frequency))</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to json</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>json_lda <span class="ot">&lt;-</span> LDAvis<span class="sc">::</span><span class="fu">createJSON</span>(</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> phi,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> theta,</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab =</span> vocab,</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">doc.length =</span> doc_length,</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">term.frequency =</span> freq_matrix<span class="sc">$</span>Freq</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Open server for visualization</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="co"># serVis(json_lda, open.browser = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="group-solution-7" class="level4">
<h4 class="anchored" data-anchor-id="group-solution-7">8 Group Solution</h4>
<div class="cell" data-hash="index_cache/html/8 Group TF-IDF Weighting Vis_d22ada1d4b0d86bd729335d89b90a913">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit largest model</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>lda.out <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm_25tfidf, <span class="dv">8</span>, <span class="at">method =</span> <span class="st">"Gibbs"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find required quantities</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>terms <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>topics <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> <span class="fu">colnames</span>(phi)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>doc_length <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(corpus)) {</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">paste</span>(corpus[[i]]<span class="sc">$</span>content, <span class="at">collapse =</span> <span class="st">' '</span>)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  doc_length <span class="ot">&lt;-</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(doc_length, <span class="fu">stri_count</span>(temp, <span class="at">regex =</span> <span class="st">'</span><span class="sc">\\</span><span class="st">S+'</span>))</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>temp_frequency <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm_25tfidf)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>freq_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ST =</span> <span class="fu">colnames</span>(temp_frequency),</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Freq =</span> <span class="fu">colSums</span>(temp_frequency))</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to json</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>json_lda <span class="ot">&lt;-</span> LDAvis<span class="sc">::</span><span class="fu">createJSON</span>(</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> phi,</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> theta,</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab =</span> vocab,</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">doc.length =</span> doc_length,</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">term.frequency =</span> freq_matrix<span class="sc">$</span>Freq</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Open server for visualization</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="co"># serVis(json_lda, open.browser = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="group-solution-8" class="level4">
<h4 class="anchored" data-anchor-id="group-solution-8">10 Group Solution</h4>
<div class="cell" data-hash="index_cache/html/10 Group TF-IDF Weighting Vis_50549172c9c710c087305ac03f7e7795">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit largest model</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>lda.out <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm_25tfidf, <span class="dv">10</span>, <span class="at">method =</span> <span class="st">"Gibbs"</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find required quantities</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>terms <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda.out)<span class="sc">$</span>topics <span class="sc">%&gt;%</span> as.matrix</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> <span class="fu">colnames</span>(phi)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>doc_length <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(corpus)) {</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">paste</span>(corpus[[i]]<span class="sc">$</span>content, <span class="at">collapse =</span> <span class="st">' '</span>)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  doc_length <span class="ot">&lt;-</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(doc_length, <span class="fu">stri_count</span>(temp, <span class="at">regex =</span> <span class="st">'</span><span class="sc">\\</span><span class="st">S+'</span>))</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>temp_frequency <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm_25tfidf)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>freq_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ST =</span> <span class="fu">colnames</span>(temp_frequency),</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Freq =</span> <span class="fu">colSums</span>(temp_frequency))</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to json</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>json_lda <span class="ot">&lt;-</span> LDAvis<span class="sc">::</span><span class="fu">createJSON</span>(</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">phi =</span> phi,</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> theta,</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab =</span> vocab,</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">doc.length =</span> doc_length,</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">term.frequency =</span> freq_matrix<span class="sc">$</span>Freq</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Open server for visualization</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="co"># serVis(json_lda, open.browser = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>A topic model for movie reviews. (n.d.). Retrieved March 20, 2023, from<br>
&nbsp;&nbsp;&nbsp;&nbsp;https://ldavis.cpsievert.me/reviews/reviews.html</p>
<p>Blei, D. M., Ng, A. Y., &amp; Jordan, M. I. (2003). Latent dirichlet allocation. Journal of machine Learning &nbsp;&nbsp;&nbsp;&nbsp;research, 3(Jan), 993-1022.</p>
<p>Fernandes, E. (2019, November 2). Text preprocessing for NLP and Machine Learning Using R. DataMathStat. Retrieved March 20, 2023, from &nbsp;&nbsp;&nbsp;&nbsp;https://datamathstat.wordpress.com/2019/10/25/text-preprocessing-for-nlp-and-machine-learning-using-r/</p>
<p>Gandrud, C. (2015, May 8). A Link Between topicmodels LDA and LDAvis. R. Retrieved March 20, &nbsp;&nbsp;&nbsp;&nbsp;2023, from https://www.r-bloggers.com/2015/05/a-link-between-topicmodels-lda-and-ldavis/</p>
<p>Grimmer, J., Roberts, M. E., &amp; Stewart, B. M. (2022). Text as data: A New Framework for Machine &nbsp;&nbsp;&nbsp;&nbsp;Learning and the Social Sciences. Princeton University Press.</p>
<p>Meza, D. (2015, July 20). Topic modeling using R · Knowledger. knowledgeR. Retrieved March 20, &nbsp;&nbsp;&nbsp;&nbsp;2023,from https://knowledger.rbind.io/post/topic-modeling-using-r/</p>
<p>Pleplé, Q. (n.d.). Perplexity To Evaluate Topic Models. qpleple. Retrieved March 20, 2023, from &nbsp;&nbsp;&nbsp;&nbsp;http://qpleple.com/perplexity-to-evaluate-topic-models/</p>
<p>Sievert, C., &amp; Shirley, K. (2014, June). LDAvis: A method for visualizing and interpreting topics. In Proceedings of the workshop on interactive language learning, visualization, and interfaces (pp.&nbsp;63-70).</p>
<p>Silge, J., Robinson, D., &amp; ProQuest (Firm). (2017). Text mining with R: A tidy approach (First ed.). &nbsp;&nbsp;&nbsp;&nbsp;O’Reilly Media.</p>
<p>Tufts, C. (n.d.). The Little Book of LDA. Latest Posts – Mining the Details. Retrieved March 20, 2023, &nbsp;&nbsp;&nbsp;&nbsp;from https://miningthedetails.com/LDA_Inference_Book/lda-inference.html</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>